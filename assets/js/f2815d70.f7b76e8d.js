"use strict";(globalThis.webpackChunkbytesofpurpose_blog=globalThis.webpackChunkbytesofpurpose_blog||[]).push([[61272],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(96540);const l={},r=i.createContext(l);function t(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(r.Provider,{value:n},e.children)}},34901:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"techniques/development-techniques/tool-composition-techniques/storybook-typescript-babel/common-pitfalls","title":"\ud83d\udd27 Storybook + TypeScript + Babel: Common Pitfalls & Issues","description":"Learn about common pitfalls, debugging tips, and issues you might encounter when setting up Storybook with TypeScript and Babel.","source":"@site/docs/6-techniques/5-development-techniques/tool-composition-techniques/storybook-typescript-babel/common-pitfalls.mdx","sourceDirName":"6-techniques/5-development-techniques/tool-composition-techniques/storybook-typescript-babel","slug":"/techniques/development-techniques/tool-composition-techniques/storybook-typescript-babel/common-pitfalls","permalink":"/docs/techniques/development-techniques/tool-composition-techniques/storybook-typescript-babel/common-pitfalls","draft":false,"unlisted":false,"editUrl":"https://github.com/omars-lab/omars-lab.github.io/edit/master/bytesofpurpose-blog/docs/6-techniques/5-development-techniques/tool-composition-techniques/storybook-typescript-babel/common-pitfalls.mdx","tags":[{"inline":true,"label":"storybook","permalink":"/docs/tags/storybook"},{"inline":true,"label":"typescript","permalink":"/docs/tags/typescript"},{"inline":true,"label":"babel","permalink":"/docs/tags/babel"},{"inline":true,"label":"webpack","permalink":"/docs/tags/webpack"},{"inline":true,"label":"build-systems","permalink":"/docs/tags/build-systems"},{"inline":true,"label":"frontend","permalink":"/docs/tags/frontend"},{"inline":true,"label":"debugging","permalink":"/docs/tags/debugging"},{"inline":true,"label":"troubleshooting","permalink":"/docs/tags/troubleshooting"}],"version":"current","frontMatter":{"title":"\ud83d\udd27 Storybook + TypeScript + Babel: Common Pitfalls & Issues","description":"Learn about common pitfalls, debugging tips, and issues you might encounter when setting up Storybook with TypeScript and Babel.","authors":["oeid"],"tags":["storybook","typescript","babel","webpack","build-systems","frontend","debugging","troubleshooting"],"slug":"common-pitfalls"},"sidebar":"tutorialSidebar","previous":{"title":"Storybook + TypeScript + Babel","permalink":"/docs/techniques/development-techniques/tool-composition-techniques/storybook-typescript-babel/readme"},"next":{"title":"\ud83d\udd27 Storybook + TypeScript + Babel: Development Process & Experience","permalink":"/docs/techniques/development-techniques/tool-composition-techniques/storybook-typescript-babel/development-process"}}');var l=s(74848),r=s(28453);const t={title:"\ud83d\udd27 Storybook + TypeScript + Babel: Common Pitfalls & Issues",description:"Learn about common pitfalls, debugging tips, and issues you might encounter when setting up Storybook with TypeScript and Babel.",authors:["oeid"],tags:["storybook","typescript","babel","webpack","build-systems","frontend","debugging","troubleshooting"],slug:"common-pitfalls"},o=void 0,c={},d=[{value:"Questions Answered by This Post",id:"questions-answered-by-this-post",level:2},{value:"The Original Problem",id:"the-original-problem",level:2},{value:"Common Pitfalls",id:"common-pitfalls",level:2},{value:"\u274c Pitfall 1: Adding Rule at the End",id:"-pitfall-1-adding-rule-at-the-end",level:3},{value:"\u274c Pitfall 2: Duplicating Babel Configuration",id:"-pitfall-2-duplicating-babel-configuration",level:3},{value:"\u274c Pitfall 3: Missing TypeScript Preset",id:"-pitfall-3-missing-typescript-preset",level:3},{value:"\u274c Pitfall 4: Wrong File Extensions in Test Pattern",id:"-pitfall-4-wrong-file-extensions-in-test-pattern",level:3},{value:"\u274c Pitfall 5: Including node_modules",id:"-pitfall-5-including-node_modules",level:3},{value:"\u274c Pitfall 6: Conflicting TypeScript Configuration",id:"-pitfall-6-conflicting-typescript-configuration",level:3},{value:"Debugging Tips",id:"debugging-tips",level:2},{value:"1. Check Loader Order",id:"1-check-loader-order",level:3},{value:"2. Verify Babel Configuration",id:"2-verify-babel-configuration",level:3},{value:"3. Check File Extensions",id:"3-check-file-extensions",level:3},{value:"4. Verify TypeScript Preset",id:"4-verify-typescript-preset",level:3},{value:"5. Check for Conflicting Rules",id:"5-check-for-conflicting-rules",level:3},{value:"Warning Signs",id:"warning-signs",level:2},{value:"Red Flags That Your Configuration Is Wrong",id:"red-flags-that-your-configuration-is-wrong",level:3},{value:"Quick Reference: Common Errors",id:"quick-reference-common-errors",level:2},{value:"Best Practices Summary",id:"best-practices-summary",level:2},{value:"Conclusion",id:"conclusion",level:2},{value:"Related Posts",id:"related-posts",level:2},{value:"References",id:"references",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"questions-answered-by-this-post",children:"Questions Answered by This Post"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"What are the most common mistakes when setting up Storybook with TypeScript?"}),"\n",(0,l.jsx)(n.li,{children:"Why does my webpack configuration fail even though it looks correct?"}),"\n",(0,l.jsx)(n.li,{children:'How do I debug "Module parse failed" errors?'}),"\n",(0,l.jsx)(n.li,{children:"What happens if I add the babel-loader rule in the wrong order?"}),"\n",(0,l.jsx)(n.li,{children:"Why shouldn't I duplicate Babel configuration in webpack?"}),"\n",(0,l.jsx)(n.li,{children:"How do I troubleshoot build errors in Storybook?"}),"\n",(0,l.jsx)(n.li,{children:"What are the warning signs that my configuration is wrong?"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["This guide covers common pitfalls, debugging tips, and issues you might encounter when setting up Storybook with TypeScript and Babel. If you're looking for the setup guide, see ",(0,l.jsx)(n.a,{href:"./setup-overview",children:"Setup & Overview"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"the-original-problem",children:"The Original Problem"}),"\n",(0,l.jsx)(n.p,{children:"When I first encountered this issue, the error was cryptic:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"ERROR in ./.storybook/preview.ts 1:12\nModule parse failed: Unexpected token (1:12)\n> import type { Preview } from '@storybook/react';\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"What this means"}),": Webpack is trying to parse TypeScript syntax directly, which it cannot do. The ",(0,l.jsx)(n.code,{children:"import type"})," syntax is TypeScript-specific and needs to be transpiled to JavaScript first."]}),"\n",(0,l.jsx)(n.h2,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,l.jsx)(n.h3,{id:"-pitfall-1-adding-rule-at-the-end",children:"\u274c Pitfall 1: Adding Rule at the End"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Mistake:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  // ... other config ...\n  \n  // \u274c WRONG: This runs AFTER other rules\n  config.module.rules.push({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Why it fails:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Webpack processes rules in order"}),"\n",(0,l.jsx)(n.li,{children:"If babel-loader runs after the CSF plugin, the plugin tries to parse TypeScript syntax"}),"\n",(0,l.jsx)(n.li,{children:"The CSF plugin expects JavaScript, not TypeScript"}),"\n",(0,l.jsxs)(n.li,{children:["Result: ",(0,l.jsx)(n.code,{children:"Module parse failed: Unexpected token"})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Fix:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  // \u2705 RIGHT: This runs BEFORE other rules\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Key insight"}),": ",(0,l.jsx)(n.code,{children:"unshift()"})," adds to the beginning, ",(0,l.jsx)(n.code,{children:"push()"})," adds to the end. We need babel-loader to run first."]}),"\n",(0,l.jsx)(n.h3,{id:"-pitfall-2-duplicating-babel-configuration",children:"\u274c Pitfall 2: Duplicating Babel Configuration"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Mistake:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,\n    use: [{\n      loader: require.resolve('babel-loader'),\n      options: {\n        // \u274c WRONG: Duplicating config that's already in babel.config.js\n        presets: [\n          ['@babel/preset-typescript', { isTSX: true, allExtensions: true }],\n          '@docusaurus/core/lib/babel/preset',\n        ],\n      },\n    }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Why it's problematic:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Duplicates configuration that's already in ",(0,l.jsx)(n.code,{children:"babel.config.js"})]}),"\n",(0,l.jsx)(n.li,{children:"Makes maintenance harder (need to update in two places)"}),"\n",(0,l.jsx)(n.li,{children:"Can lead to inconsistencies"}),"\n",(0,l.jsxs)(n.li,{children:["babel-loader automatically finds ",(0,l.jsx)(n.code,{children:"babel.config.js"})," from the project root"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Fix:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,\n    use: [{\n      loader: require.resolve('babel-loader'),\n      // \u2705 RIGHT: No options needed - babel-loader finds babel.config.js automatically\n    }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Key insight"}),": Let babel-loader do its job - it automatically discovers ",(0,l.jsx)(n.code,{children:"babel.config.js"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"-pitfall-3-missing-typescript-preset",children:"\u274c Pitfall 3: Missing TypeScript Preset"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Mistake:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"// babel.config.js\nmodule.exports = {\n  presets: [\n    // \u274c WRONG: Missing @babel/preset-typescript\n    require.resolve('@docusaurus/core/lib/babel/preset'),\n  ],\n};\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Why it fails:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Babel doesn't know how to handle TypeScript syntax"}),"\n",(0,l.jsxs)(n.li,{children:["Type annotations and ",(0,l.jsx)(n.code,{children:"import type"})," statements aren't stripped"]}),"\n",(0,l.jsx)(n.li,{children:"Webpack receives TypeScript code instead of JavaScript"}),"\n",(0,l.jsxs)(n.li,{children:["Result: ",(0,l.jsx)(n.code,{children:"Module parse failed: Unexpected token"})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Fix:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"// babel.config.js\nmodule.exports = {\n  presets: [\n    // \u2705 RIGHT: Include TypeScript preset\n    [require.resolve('@babel/preset-typescript'), { \n      isTSX: true, \n      allExtensions: true \n    }],\n    require.resolve('@docusaurus/core/lib/babel/preset'),\n  ],\n};\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Key insight"}),": The TypeScript preset is essential - it tells Babel how to handle TypeScript syntax."]}),"\n",(0,l.jsx)(n.h3,{id:"-pitfall-4-wrong-file-extensions-in-test-pattern",children:"\u274c Pitfall 4: Wrong File Extensions in Test Pattern"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Mistake:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  config.module.rules.unshift({\n    test: /\\.ts$/,  // \u274c WRONG: Missing .tsx\n    exclude: /node_modules/,\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Why it fails:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Only matches ",(0,l.jsx)(n.code,{children:".ts"})," files, not ",(0,l.jsx)(n.code,{children:".tsx"})," files"]}),"\n",(0,l.jsxs)(n.li,{children:["React components with JSX (",(0,l.jsx)(n.code,{children:".tsx"}),") won't be processed"]}),"\n",(0,l.jsx)(n.li,{children:"Result: Some files work, others don't"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Fix:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,  // \u2705 RIGHT: Matches both .ts and .tsx\n    exclude: /node_modules/,\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Key insight"}),": React components use ",(0,l.jsx)(n.code,{children:".tsx"})," - make sure your pattern matches both extensions."]}),"\n",(0,l.jsx)(n.h3,{id:"-pitfall-5-including-node_modules",children:"\u274c Pitfall 5: Including node_modules"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Mistake:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    // \u274c WRONG: Missing exclude - processes node_modules\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Why it's problematic:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Processes TypeScript files in ",(0,l.jsx)(n.code,{children:"node_modules"})]}),"\n",(0,l.jsx)(n.li,{children:"Slows down builds significantly"}),"\n",(0,l.jsx)(n.li,{children:"Can cause conflicts with pre-compiled packages"}),"\n",(0,l.jsx)(n.li,{children:"Usually unnecessary (most packages are already compiled)"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Fix:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,  // \u2705 RIGHT: Exclude node_modules\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Key insight"}),": Always exclude ",(0,l.jsx)(n.code,{children:"node_modules"})," unless you have a specific reason not to."]}),"\n",(0,l.jsx)(n.h3,{id:"-pitfall-6-conflicting-typescript-configuration",children:"\u274c Pitfall 6: Conflicting TypeScript Configuration"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Mistake:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'// tsconfig.json\n{\n  "compilerOptions": {\n    "module": "CommonJS",  // \u274c WRONG: Conflicts with modern bundlers\n    "moduleResolution": "node",\n    // ...\n  }\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Why it's problematic:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"CommonJS"})," module system conflicts with modern bundlers"]}),"\n",(0,l.jsx)(n.li,{children:"Can cause issues with tree-shaking and code splitting"}),"\n",(0,l.jsxs)(n.li,{children:["Doesn't work well with ",(0,l.jsx)(n.code,{children:'moduleResolution: "bundler"'})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The Fix:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'// tsconfig.json\n{\n  "compilerOptions": {\n    "module": "ESNext",  // \u2705 RIGHT: Works with modern bundlers\n    "moduleResolution": "bundler",\n    // ...\n  }\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Key insight"}),": Use modern module systems (",(0,l.jsx)(n.code,{children:"ESNext"}),") when working with bundlers like webpack."]}),"\n",(0,l.jsx)(n.h2,{id:"debugging-tips",children:"Debugging Tips"}),"\n",(0,l.jsx)(n.h3,{id:"1-check-loader-order",children:"1. Check Loader Order"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How to debug:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  // Log the rules to see their order\n  console.log('Webpack rules:', config.module.rules.map(r => r.test));\n  \n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"What to look for:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"babel-loader rule should be first (or early in the list)"}),"\n",(0,l.jsx)(n.li,{children:"CSF plugin should come after babel-loader"}),"\n",(0,l.jsx)(n.li,{children:"Check that your rule is actually being added"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"2-verify-babel-configuration",children:"2. Verify Babel Configuration"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How to debug:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Test Babel configuration directly\nnpx babel src/your-file.ts --out-file test-output.js\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"What to look for:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"TypeScript syntax should be removed"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"import type"})," should be stripped"]}),"\n",(0,l.jsx)(n.li,{children:"Output should be valid JavaScript"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"3-check-file-extensions",children:"3. Check File Extensions"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How to debug:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  // Log which files are being processed\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,\n    use: [{\n      loader: require.resolve('babel-loader'),\n      options: {\n        // This will log each file being processed\n        onDebug: (options, context) => {\n          console.log('Processing:', context.resourcePath);\n        },\n      },\n    }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"What to look for:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Files with ",(0,l.jsx)(n.code,{children:".ts"})," and ",(0,l.jsx)(n.code,{children:".tsx"})," extensions should be logged"]}),"\n",(0,l.jsxs)(n.li,{children:["Files in ",(0,l.jsx)(n.code,{children:"node_modules"})," should NOT be logged"]}),"\n",(0,l.jsx)(n.li,{children:"All your source files should appear"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"4-verify-typescript-preset",children:"4. Verify TypeScript Preset"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How to debug:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"// babel.config.js\nmodule.exports = {\n  presets: [\n    [require.resolve('@babel/preset-typescript'), { \n      isTSX: true, \n      allExtensions: true \n    }],\n    require.resolve('@docusaurus/core/lib/babel/preset'),\n  ],\n};\n\n// Test: Check if preset is loaded\nconsole.log('Babel presets:', module.exports.presets);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"What to look for:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"@babel/preset-typescript"})," should be in the presets array"]}),"\n",(0,l.jsxs)(n.li,{children:["Options should match your needs (",(0,l.jsx)(n.code,{children:"isTSX: true"})," for React)"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"5-check-for-conflicting-rules",children:"5. Check for Conflicting Rules"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How to debug:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"webpackFinal: async (config) => {\n  // Check for existing TypeScript rules\n  const existingTsRule = config.module.rules.find(\n    rule => rule.test && rule.test.toString().includes('ts')\n  );\n  \n  if (existingTsRule) {\n    console.warn('Found existing TypeScript rule:', existingTsRule);\n  }\n  \n  // Your babel-loader rule\n  config.module.rules.unshift({\n    test: /\\.(ts|tsx)$/,\n    exclude: /node_modules/,\n    use: [{ loader: require.resolve('babel-loader') }],\n  });\n  \n  return config;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"What to look for:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Other rules that might conflict"}),"\n",(0,l.jsx)(n.li,{children:"Rules that process TypeScript files differently"}),"\n",(0,l.jsx)(n.li,{children:"Order of conflicting rules"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"warning-signs",children:"Warning Signs"}),"\n",(0,l.jsx)(n.h3,{id:"red-flags-that-your-configuration-is-wrong",children:"Red Flags That Your Configuration Is Wrong"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:'"Module parse failed: Unexpected token"'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Webpack is trying to parse TypeScript directly"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Fix"}),": Ensure babel-loader runs first"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Some files work, others don't"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Check file extension patterns (",(0,l.jsx)(n.code,{children:".ts"})," vs ",(0,l.jsx)(n.code,{children:".tsx"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:["Check ",(0,l.jsx)(n.code,{children:"exclude"})," patterns"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Build is very slow"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["You might be processing ",(0,l.jsx)(n.code,{children:"node_modules"})]}),"\n",(0,l.jsxs)(n.li,{children:["Check your ",(0,l.jsx)(n.code,{children:"exclude"})," pattern"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"TypeScript errors in build output"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Babel might not be configured correctly"}),"\n",(0,l.jsxs)(n.li,{children:["Check that ",(0,l.jsx)(n.code,{children:"@babel/preset-typescript"})," is included"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Inconsistent behavior between dev and build"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Different webpack configurations"}),"\n",(0,l.jsxs)(n.li,{children:["Check both ",(0,l.jsx)(n.code,{children:".storybook/main.ts"})," and build configs"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"quick-reference-common-errors",children:"Quick Reference: Common Errors"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Error Message"}),(0,l.jsx)(n.th,{children:"Likely Cause"}),(0,l.jsx)(n.th,{children:"Solution"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Module parse failed: Unexpected token"})}),(0,l.jsx)(n.td,{children:"Webpack parsing TypeScript directly"}),(0,l.jsx)(n.td,{children:"Add babel-loader rule first"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Cannot find module"})}),(0,l.jsx)(n.td,{children:"TypeScript config issue"}),(0,l.jsxs)(n.td,{children:["Check ",(0,l.jsx)(n.code,{children:"tsconfig.json"})," paths"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"SyntaxError: Unexpected token"})}),(0,l.jsx)(n.td,{children:"Missing TypeScript preset"}),(0,l.jsxs)(n.td,{children:["Add ",(0,l.jsx)(n.code,{children:"@babel/preset-typescript"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Build works but types are wrong"}),(0,l.jsx)(n.td,{children:"TypeScript not checking"}),(0,l.jsxs)(n.td,{children:["Check ",(0,l.jsx)(n.code,{children:"tsconfig.json"})," settings"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Some files fail, others work"}),(0,l.jsx)(n.td,{children:"Wrong file extension pattern"}),(0,l.jsxs)(n.td,{children:["Use ",(0,l.jsx)(n.code,{children:"/\\.(ts|tsx)$/"})]})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"best-practices-summary",children:"Best Practices Summary"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsxs)(n.strong,{children:["Always use ",(0,l.jsx)(n.code,{children:"unshift()"})]})," - Add babel-loader rule at the beginning"]}),"\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.strong,{children:"Don't duplicate config"})," - Let babel-loader find ",(0,l.jsx)(n.code,{children:"babel.config.js"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.strong,{children:"Include TypeScript preset"})," - Essential for TypeScript support"]}),"\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.strong,{children:"Match both extensions"})," - Use ",(0,l.jsx)(n.code,{children:"/\\.(ts|tsx)$/"})," pattern"]}),"\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.strong,{children:"Exclude node_modules"})," - Always exclude for performance"]}),"\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.strong,{children:"Use modern module system"})," - ",(0,l.jsx)(n.code,{children:"ESNext"})," with ",(0,l.jsx)(n.code,{children:'moduleResolution: "bundler"'})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,l.jsx)(n.p,{children:"Most issues stem from:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Wrong loader order"})," - babel-loader must run first"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Missing TypeScript preset"})," - Babel needs to know how to handle TypeScript"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Configuration duplication"})," - Let babel-loader discover config automatically"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Wrong file patterns"})," - Make sure to match both ",(0,l.jsx)(n.code,{children:".ts"})," and ",(0,l.jsx)(n.code,{children:".tsx"})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"When in doubt, check the loader order and verify that babel-loader is processing files before other loaders try to parse them."}),"\n",(0,l.jsx)(n.h2,{id:"related-posts",children:"Related Posts"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["For the ",(0,l.jsx)(n.strong,{children:"setup guide"}),", see ",(0,l.jsx)(n.a,{href:"./setup-overview",children:"Setup & Overview"})]}),"\n",(0,l.jsxs)(n.li,{children:["For ",(0,l.jsx)(n.strong,{children:"understanding the tools"})," and their responsibilities, see ",(0,l.jsx)(n.a,{href:"./understanding-tools",children:"Understanding the Tools"})]}),"\n",(0,l.jsxs)(n.li,{children:["For ",(0,l.jsx)(n.strong,{children:"the development process and build flow"}),", see ",(0,l.jsx)(n.a,{href:"./development-process",children:"Development Process & Experience"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://storybook.js.org/docs/configure/typescript",children:"Storybook TypeScript Configuration"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://babeljs.io/docs/en/babel-preset-typescript",children:"Babel TypeScript Preset"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://webpack.js.org/concepts/loaders/",children:"Webpack Loaders"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://storybook.js.org/docs/builders/webpack",children:"Storybook Webpack Configuration"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);