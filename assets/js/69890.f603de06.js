"use strict";(globalThis.webpackChunkbytesofpurpose_blog=globalThis.webpackChunkbytesofpurpose_blog||[]).push([[69890],{69890:(t,i,e)=>{e.r(i),e.d(i,{NodeRenderer:()=>s});class s{static NEO4J_COLORS=["#68BDF6","#60BE86","#FF6B6B","#FFD93D","#A78BFA","#FB7185","#34D399","#FBBF24"];static MAX_CHARS=10;static CHARS_BEFORE_ELLIPSIS=7;static DEBUG_SHOW_NODE_SECTIONS=!1;constructor(t){this.ctx=t.ctx,this.node=t.node,this.globalScale=t.globalScale,this.isDarkMode=t.isDarkMode,this.isHighlighted=t.isHighlighted,this.isSelected=t.isSelected??!1,this.nodeBorderColor=t.nodeBorderColor,this.showDebugSeparators=t.showDebugSeparators??!1,this.metrics=this.calculateMetrics()}render(){if(!this.isValidCoordinates())return;this.drawCircle(),(this.showDebugSeparators||s.DEBUG_SHOW_NODE_SECTIONS)&&this.drawDebugSeparators();this.metrics.label&&this.drawTitle()}calculateMetrics(){const t=this.getNodeRadius(this.node.hasChildren),i=2*t;return{radius:t,diameter:i,sectionHeight:i/5,color:this.getNodeColor(this.node.color),label:this.getNodeLabel(this.node)}}isValidCoordinates(){return void 0!==this.node.x&&void 0!==this.node.y&&isFinite(this.node.x)&&isFinite(this.node.y)}getNodeRadius(t){return t?12:8}getNodeColor(t){return t||s.NEO4J_COLORS[0]}getNodeLabel(t){return t.title||t.name||t.id||""}drawCircle(){const{x:t,y:i}=this.node,{radius:e,color:s}=this.metrics;if(this.isSelected){const s=e+16,a=this.ctx.createRadialGradient(t,i,.9*e,t,i,s);a.addColorStop(0,"rgba(255, 248, 220, 0.2)"),a.addColorStop(.4,"rgba(255, 235, 180, 0.15)"),a.addColorStop(.7,"rgba(255, 220, 150, 0.08)"),a.addColorStop(1,"transparent"),this.ctx.fillStyle=a,this.ctx.beginPath(),this.ctx.arc(t,i,s,0,2*Math.PI,!1),this.ctx.fill();const r=e+8,o=this.ctx.createRadialGradient(t,i,.7*e,t,i,r);o.addColorStop(0,"rgba(255, 245, 200, 0.3)"),o.addColorStop(.5,"rgba(255, 230, 160, 0.2)"),o.addColorStop(.8,"rgba(255, 210, 130, 0.1)"),o.addColorStop(1,"transparent"),this.ctx.fillStyle=o,this.ctx.beginPath(),this.ctx.arc(t,i,r,0,2*Math.PI,!1),this.ctx.fill();const h=e+4,l=this.ctx.createRadialGradient(t,i,.4*e,t,i,h);l.addColorStop(0,"rgba(255, 255, 240, 0.5)"),l.addColorStop(.3,"rgba(255, 245, 200, 0.3)"),l.addColorStop(.7,"rgba(255, 230, 180, 0.15)"),l.addColorStop(1,"transparent"),this.ctx.fillStyle=l,this.ctx.beginPath(),this.ctx.arc(t,i,h,0,2*Math.PI,!1),this.ctx.fill();const c=this.ctx.createRadialGradient(t,i,.15*e,t,i,e);c.addColorStop(0,"#FFFEF7"),c.addColorStop(.2,"#FFF8E1"),c.addColorStop(.4,"#FFE082"),c.addColorStop(.6,"#FFC947"),c.addColorStop(.8,"#FFB300"),c.addColorStop(1,"#FF8F00"),this.ctx.fillStyle=c,this.ctx.beginPath(),this.ctx.arc(t,i,e,0,2*Math.PI,!1),this.ctx.fill()}else{if(this.isHighlighted){const s=e+4,a=this.ctx.createRadialGradient(t,i,e,t,i,s);a.addColorStop(0,this.isDarkMode?"rgba(255, 215, 0, 0.8)":"rgba(255, 215, 0, 0.6)"),a.addColorStop(1,"transparent"),this.ctx.fillStyle=a,this.ctx.beginPath(),this.ctx.arc(t,i,s,0,2*Math.PI,!1),this.ctx.fill()}this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(t,i,e,0,2*Math.PI,!1),this.ctx.fill(),this.isHighlighted?(this.ctx.strokeStyle=this.isDarkMode?"#FFD700":"#FFA500",this.ctx.lineWidth=4/this.globalScale):(this.ctx.strokeStyle=this.nodeBorderColor,this.ctx.lineWidth=2/this.globalScale),this.ctx.stroke()}}drawDebugSeparators(){if(!s.DEBUG_SHOW_NODE_SECTIONS&&!this.showDebugSeparators)return;const{x:t,y:i}=this.node,{radius:e,sectionHeight:a}=this.metrics;this.ctx.strokeStyle="rgba(255, 0, 0, 0.8)",this.ctx.lineWidth=2/this.globalScale;const r=3/this.globalScale;this.ctx.setLineDash([r,r]);for(let s=1;s<5;s++){const r=i-e+a*s;this.ctx.beginPath();const o=Math.asin((r-i)/e),h=Math.cos(o)*e;this.ctx.moveTo(t-h,r),this.ctx.lineTo(t+h,r),this.ctx.stroke()}this.ctx.setLineDash([])}getStatusIndicator(){const t=this.node.hasChildren,i=this.node.isExpanded||!1;return t?{indicator:i?"\u25bc":"\u25b6",isTextLabel:!1}:{indicator:"\ud83c\udf3f",isTextLabel:!1}}calculateEmojiAreaCenterY(){const{y:t}=this.node,{radius:i,sectionHeight:e}=this.metrics;return(t-i+4*e+(t+i))/2}calculateAvailableTextWidth(t,i=6,e){const{y:s}=this.node,{radius:a}=this.metrics,r=Math.abs(t-s),o=2*Math.sqrt(Math.max(0,a*a-r*r)),h=i*this.globalScale,l=o*this.globalScale-2*h,c=0===e||2===e,d=l-(l*((c?.15:.1)*(1+(a-8)/8*.3))+(c?5:4)*(a/8)*this.globalScale);return Math.max(2,d)}calculateLinePosition(){const{y:t}=this.node,{radius:i,sectionHeight:e}=this.metrics;return(t-i+2*e+(t-i+3*e))/2}truncateToMaxChars(t){return t.length<=s.MAX_CHARS?t:t.substring(0,s.CHARS_BEFORE_ELLIPSIS)+"..."}drawTitle(){const t=this.calculateEmojiAreaCenterY(),i=String(this.metrics.label||this.node.id||"");if(!i||!i.trim())return t;const e=i.trim();if(0===e.length)return t;const s=this.truncateToMaxChars(e);this.ctx.save();const{x:a,y:r}=this.node,{radius:o}=this.metrics;this.ctx.beginPath(),this.ctx.arc(a,r,o,0,2*Math.PI),this.ctx.clip();try{const{radius:t}=this.metrics,i=this.calculateLinePosition(),e=this.calculateAvailableTextWidth(i,6,1),r=t>=12?4:3,o=t>=12?6:5;let h=r;this.ctx.font=`${h}px Sans-Serif`;let l=this.ctx.measureText(s).width;for(;l>.8*e&&h>r;)h=Math.max(r,h-.5),this.ctx.font=`${h}px Sans-Serif`,l=this.ctx.measureText(s).width;if(l>.8*e&&h>r){const t=.8*e/l;h=Math.max(r,h*t)}h=Math.min(h,o),this.ctx.font=`${h}px Sans-Serif`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle=this.isSelected?"#1a1a1a":"#ffffff",this.ctx.fillText(s,a,i)}finally{this.ctx.restore()}return t}drawStatusIndicator(t,i){const{x:e}=this.node,{radius:s}=this.metrics,{indicator:a,isTextLabel:r}=i;let o=s*this.globalScale*(r?.03:.07);const h=r?s<=8?4:5:s<=8?8:10;o=Math.min(o,h);const l=r?2:6;o=Math.max(l,o),this.ctx.save(),r&&(this.ctx.translate(e,t),this.ctx.rotate(-.2),this.ctx.translate(-e,-t)),this.ctx.font=`${o}px Sans-Serif`,this.ctx.fillStyle="#ffffff",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(a,e,t),this.ctx.restore()}getMetrics(){return{...this.metrics}}}}}]);