"use strict";(globalThis.webpackChunkbytesofpurpose_blog=globalThis.webpackChunkbytesofpurpose_blog||[]).push([[74323],{28453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>r});var t=n(96540);const a={},i=t.createContext(a);function c(e){const s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),t.createElement(i.Provider,{value:s},e.children)}},28712:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"techniques/scripting-techniques/parsing-json","title":"JQ Mechanics","description":"What JQ mechanics do I commonly leverage?","source":"@site/docs/6-techniques/7-scripting-techniques/parsing-json.md","sourceDirName":"6-techniques/7-scripting-techniques","slug":"/techniques/scripting-techniques/jq-mechanics","permalink":"/docs/techniques/scripting-techniques/jq-mechanics","draft":false,"unlisted":false,"editUrl":"https://github.com/omars-lab/omars-lab.github.io/edit/master/bytesofpurpose-blog/docs/6-techniques/7-scripting-techniques/parsing-json.md","tags":[],"version":"current","frontMatter":{"title":"JQ Mechanics","description":"What JQ mechanics do I commonly leverage?","slug":"jq-mechanics","authors":["oeid"],"tags":[],"image":"https://i.imgur.com/mErPwqL.png"},"sidebar":"changelogSidebar","previous":{"title":"Terminal Shortcuts","permalink":"/docs/techniques/scripting-techniques/terminal-shortcuts"},"next":{"title":"Terminal Calendar","permalink":"/docs/techniques/scripting-techniques/terminal-calendar"}}');var a=n(74848),i=n(28453);const c={title:"JQ Mechanics",description:"What JQ mechanics do I commonly leverage?",slug:"jq-mechanics",authors:["oeid"],tags:[],image:"https://i.imgur.com/mErPwqL.png"},r="JQ Command Examples",o={},l=[{value:"Mock Data Setup",id:"mock-data-setup",level:2},{value:"Example 1: Extract and Format Timestamps",id:"example-1-extract-and-format-timestamps",level:2},{value:"Additional JQ Examples",id:"additional-jq-examples",level:2},{value:"Filter by Status",id:"filter-by-status",level:3},{value:"Count Items",id:"count-items",level:3},{value:"Group by User",id:"group-by-user",level:3},{value:"Extract Specific Fields",id:"extract-specific-fields",level:3}];function d(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"jq-command-examples",children:"JQ Command Examples"})}),"\n",(0,a.jsx)(s.p,{children:"This document demonstrates powerful jq commands for JSON processing and manipulation."}),"\n",(0,a.jsx)(s.h2,{id:"mock-data-setup",children:"Mock Data Setup"}),"\n",(0,a.jsx)(s.p,{children:"First, let's create a mock JSON file to work with:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:'cat > mock_data.json << \'EOF\'\n{\n  "logs": [\n    {\n      "id": "act_001",\n      "eventTime": 1704067200000,\n      "message": "Hello"\n    },\n    {\n      "id": "act_002", \n      "eventTime": 1704153600000,\n      "user": "How"\n    },\n    {\n      "id": "act_003",\n      "eventTime": 1704240000000,\n      "user": "Are You?"\n    }\n  ]\n}\nEOF\n'})}),"\n",(0,a.jsx)(s.h2,{id:"example-1-extract-and-format-timestamps",children:"Example 1: Extract and Format Timestamps"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Command:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"cat mock_data.json \\\n    | jq -r '[ .logs | .[] | .eventTime] | sort | reverse | .[]' \\\n    | xargs -I {} bash -c 'date -r $(expr {} / 1000) 2>/dev/null || date -d @$(expr {} / 1000) 2>/dev/null'\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"What this does:"})}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"cat mock_data.json"})," - Reads the JSON file"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"jq -r '[ .logs | .[] | .eventTime] | sort | reverse | .[]'"})," - Extracts all eventTime timestamps, sorts them in reverse order, and outputs raw values"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"xargs -I {} bash -c '...'"})," - For each timestamp, converts it to a readable date format"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"date -r $(expr {} / 1000)"})," - Converts Unix timestamp (milliseconds) to date (macOS)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"date -d @$(expr {} / 1000)"})," - Converts Unix timestamp (milliseconds) to date (Linux)"]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Expected Output:"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"Fri Jan 05 12:00:00 UTC 2024\nThu Jan 04 12:00:00 UTC 2024\nWed Jan 03 12:00:00 UTC 2024\n"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Use Case"}),"\nI was debugging a systems logs to determine what the most recent time a set of logs occured on."]}),"\n",(0,a.jsx)(s.h2,{id:"additional-jq-examples",children:"Additional JQ Examples"}),"\n",(0,a.jsx)(s.h3,{id:"filter-by-status",children:"Filter by Status"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"cat mock_data.json | jq '.logs[] | select(.status == \"completed\")'\n"})}),"\n",(0,a.jsx)(s.h3,{id:"count-items",children:"Count Items"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"cat mock_data.json | jq '.logs | length'\n"})}),"\n",(0,a.jsx)(s.h3,{id:"group-by-user",children:"Group by User"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"cat mock_data.json | jq '.logs | group_by(.user) | map({user: .[0].user, count: length})'\n"})}),"\n",(0,a.jsx)(s.h3,{id:"extract-specific-fields",children:"Extract Specific Fields"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"cat mock_data.json | jq '.logs[] | {id, user, duration: (.end - .eventTime)}'\n"})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);