"use strict";(globalThis.webpackChunkbytesofpurpose_blog=globalThis.webpackChunkbytesofpurpose_blog||[]).push([[752],{"./src/components/Graph/NodeRenderer.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{NodeRenderer:()=>NodeRenderer});class NodeRenderer{static NEO4J_COLORS=["#68BDF6","#60BE86","#FF6B6B","#FFD93D","#A78BFA","#FB7185","#34D399","#FBBF24"];static MAX_CHARS=10;static CHARS_BEFORE_ELLIPSIS=7;static DEBUG_SHOW_NODE_SECTIONS=!1;constructor(options){this.ctx=options.ctx,this.node=options.node,this.globalScale=options.globalScale,this.isDarkMode=options.isDarkMode,this.isHighlighted=options.isHighlighted,this.isSelected=options.isSelected??!1,this.nodeBorderColor=options.nodeBorderColor,this.showDebugSeparators=options.showDebugSeparators??!1,this.metrics=this.calculateMetrics()}render(){if(!this.isValidCoordinates())return;this.drawCircle(),(this.showDebugSeparators||NodeRenderer.DEBUG_SHOW_NODE_SECTIONS)&&this.drawDebugSeparators();this.metrics.label&&this.drawTitle()}calculateMetrics(){const radius=this.getNodeRadius(this.node.hasChildren),diameter=2*radius;return{radius,diameter,sectionHeight:diameter/5,color:this.getNodeColor(this.node.color),label:this.getNodeLabel(this.node)}}isValidCoordinates(){return void 0!==this.node.x&&void 0!==this.node.y&&isFinite(this.node.x)&&isFinite(this.node.y)}getNodeRadius(hasChildren){return hasChildren?12:8}getNodeColor(nodeColor){return nodeColor||NodeRenderer.NEO4J_COLORS[0]}getNodeLabel(node){return node.title||node.name||node.id||""}drawCircle(){const{x,y}=this.node,{radius,color}=this.metrics;if(this.isSelected){const auraRadius=radius+16,auraGradient=this.ctx.createRadialGradient(x,y,.9*radius,x,y,auraRadius);auraGradient.addColorStop(0,"rgba(255, 248, 220, 0.2)"),auraGradient.addColorStop(.4,"rgba(255, 235, 180, 0.15)"),auraGradient.addColorStop(.7,"rgba(255, 220, 150, 0.08)"),auraGradient.addColorStop(1,"transparent"),this.ctx.fillStyle=auraGradient,this.ctx.beginPath(),this.ctx.arc(x,y,auraRadius,0,2*Math.PI,!1),this.ctx.fill();const outerGlowRadius=radius+8,outerGradient=this.ctx.createRadialGradient(x,y,.7*radius,x,y,outerGlowRadius);outerGradient.addColorStop(0,"rgba(255, 245, 200, 0.3)"),outerGradient.addColorStop(.5,"rgba(255, 230, 160, 0.2)"),outerGradient.addColorStop(.8,"rgba(255, 210, 130, 0.1)"),outerGradient.addColorStop(1,"transparent"),this.ctx.fillStyle=outerGradient,this.ctx.beginPath(),this.ctx.arc(x,y,outerGlowRadius,0,2*Math.PI,!1),this.ctx.fill();const innerGlowRadius=radius+4,innerGradient=this.ctx.createRadialGradient(x,y,.4*radius,x,y,innerGlowRadius);innerGradient.addColorStop(0,"rgba(255, 255, 240, 0.5)"),innerGradient.addColorStop(.3,"rgba(255, 245, 200, 0.3)"),innerGradient.addColorStop(.7,"rgba(255, 230, 180, 0.15)"),innerGradient.addColorStop(1,"transparent"),this.ctx.fillStyle=innerGradient,this.ctx.beginPath(),this.ctx.arc(x,y,innerGlowRadius,0,2*Math.PI,!1),this.ctx.fill();const sunGradient=this.ctx.createRadialGradient(x,y,.15*radius,x,y,radius);sunGradient.addColorStop(0,"#FFFEF7"),sunGradient.addColorStop(.2,"#FFF8E1"),sunGradient.addColorStop(.4,"#FFE082"),sunGradient.addColorStop(.6,"#FFC947"),sunGradient.addColorStop(.8,"#FFB300"),sunGradient.addColorStop(1,"#FF8F00"),this.ctx.fillStyle=sunGradient,this.ctx.beginPath(),this.ctx.arc(x,y,radius,0,2*Math.PI,!1),this.ctx.fill()}else{if(this.isHighlighted){const glowRadius=radius+4,gradient=this.ctx.createRadialGradient(x,y,radius,x,y,glowRadius);gradient.addColorStop(0,this.isDarkMode?"rgba(255, 215, 0, 0.8)":"rgba(255, 215, 0, 0.6)"),gradient.addColorStop(1,"transparent"),this.ctx.fillStyle=gradient,this.ctx.beginPath(),this.ctx.arc(x,y,glowRadius,0,2*Math.PI,!1),this.ctx.fill()}this.ctx.fillStyle=color,this.ctx.beginPath(),this.ctx.arc(x,y,radius,0,2*Math.PI,!1),this.ctx.fill(),this.isHighlighted?(this.ctx.strokeStyle=this.isDarkMode?"#FFD700":"#FFA500",this.ctx.lineWidth=4/this.globalScale):(this.ctx.strokeStyle=this.nodeBorderColor,this.ctx.lineWidth=2/this.globalScale),this.ctx.stroke()}}drawDebugSeparators(){if(!NodeRenderer.DEBUG_SHOW_NODE_SECTIONS&&!this.showDebugSeparators)return;const{x,y}=this.node,{radius,sectionHeight}=this.metrics;this.ctx.strokeStyle="rgba(255, 0, 0, 0.8)",this.ctx.lineWidth=2/this.globalScale;const dashSize=3/this.globalScale;this.ctx.setLineDash([dashSize,dashSize]);for(let i=1;i<5;i++){const yPos=y-radius+sectionHeight*i;this.ctx.beginPath();const angle=Math.asin((yPos-y)/radius),xOffset=Math.cos(angle)*radius;this.ctx.moveTo(x-xOffset,yPos),this.ctx.lineTo(x+xOffset,yPos),this.ctx.stroke()}this.ctx.setLineDash([])}getStatusIndicator(){const hasChildren=this.node.hasChildren,isExpanded=this.node.isExpanded||!1;return hasChildren?{indicator:isExpanded?"â–¼":"â–¶",isTextLabel:!1}:{indicator:"ðŸŒ¿",isTextLabel:!1}}calculateEmojiAreaCenterY(){const{y}=this.node,{radius,sectionHeight}=this.metrics;return(y-radius+4*sectionHeight+(y+radius))/2}calculateAvailableTextWidth(y,padding=6,lineIndex){const{y:nodeY}=this.node,{radius}=this.metrics,verticalOffset=Math.abs(y-nodeY),chordWidth=2*Math.sqrt(Math.max(0,radius*radius-verticalOffset*verticalOffset)),screenPadding=padding*this.globalScale,baseWidth=chordWidth*this.globalScale-2*screenPadding,isTopOrBottom=0===lineIndex||2===lineIndex,availableWidth=baseWidth-(baseWidth*((isTopOrBottom?.15:.1)*(1+(radius-8)/8*.3))+(isTopOrBottom?5:4)*(radius/8)*this.globalScale);return Math.max(2,availableWidth)}calculateLinePosition(){const{y}=this.node,{radius,sectionHeight}=this.metrics;return(y-radius+2*sectionHeight+(y-radius+3*sectionHeight))/2}truncateToMaxChars(text){return text.length<=NodeRenderer.MAX_CHARS?text:text.substring(0,NodeRenderer.CHARS_BEFORE_ELLIPSIS)+"..."}drawTitle(){const emojiAreaCenterY=this.calculateEmojiAreaCenterY(),labelStr=String(this.metrics.label||this.node.id||"");if(!labelStr||!labelStr.trim())return emojiAreaCenterY;const trimmed=labelStr.trim();if(0===trimmed.length)return emojiAreaCenterY;const displayText=this.truncateToMaxChars(trimmed);this.ctx.save();const{x,y}=this.node,{radius}=this.metrics;this.ctx.beginPath(),this.ctx.arc(x,y,radius,0,2*Math.PI),this.ctx.clip();try{const{radius}=this.metrics,lineY=this.calculateLinePosition(),availableWidth=this.calculateAvailableTextWidth(lineY,6,1),minFontSize=radius>=12?4:3,maxFontSize=radius>=12?6:5;let fontSize=minFontSize;this.ctx.font=`${fontSize}px Sans-Serif`;let textWidth=this.ctx.measureText(displayText).width;for(;textWidth>.8*availableWidth&&fontSize>minFontSize;)fontSize=Math.max(minFontSize,fontSize-.5),this.ctx.font=`${fontSize}px Sans-Serif`,textWidth=this.ctx.measureText(displayText).width;if(textWidth>.8*availableWidth&&fontSize>minFontSize){const scaleFactor=.8*availableWidth/textWidth;fontSize=Math.max(minFontSize,fontSize*scaleFactor)}fontSize=Math.min(fontSize,maxFontSize),this.ctx.font=`${fontSize}px Sans-Serif`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle=this.isSelected?"#1a1a1a":"#ffffff",this.ctx.fillText(displayText,x,lineY)}finally{this.ctx.restore()}return emojiAreaCenterY}drawStatusIndicator(emojiAreaCenterY,statusInfo){const{x}=this.node,{radius}=this.metrics,{indicator,isTextLabel}=statusInfo;let fontSize=radius*this.globalScale*(isTextLabel?.03:.07);const maxFontSizeScreen=isTextLabel?radius<=8?4:5:radius<=8?8:10;fontSize=Math.min(fontSize,maxFontSizeScreen);const minFontSize=isTextLabel?2:6;fontSize=Math.max(minFontSize,fontSize),this.ctx.save(),isTextLabel&&(this.ctx.translate(x,emojiAreaCenterY),this.ctx.rotate(-.2),this.ctx.translate(-x,-emojiAreaCenterY)),this.ctx.font=`${fontSize}px Sans-Serif`,this.ctx.fillStyle="#ffffff",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(indicator,x,emojiAreaCenterY),this.ctx.restore()}getMetrics(){return{...this.metrics}}}}}]);